This doesn't work yet.  But it's close.